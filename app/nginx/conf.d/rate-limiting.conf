# ===== RATE LIMITING ZONES =====

# Zona para login (mais restritiva)
# 5 requisições por minuto por IP
limit_req_zone $binary_remote_addr zone=login_zone:10m rate=5r/m;

# Zona para registro (muito restritiva)
# 3 requisições por minuto por IP
limit_req_zone $binary_remote_addr zone=register_zone:10m rate=3r/m;

# Zona para API geral
# 100 requisições por minuto por IP
limit_req_zone $binary_remote_addr zone=api_zone:10m rate=100r/m;

# Zona para transações
# 20 requisições por minuto por IP
limit_req_zone $binary_remote_addr zone=transaction_zone:10m rate=20r/m;

# Zona para frontend/static
# 200 requisições por minuto por IP
limit_req_zone $binary_remote_addr zone=static_zone:10m rate=200r/m;

# Limite de conexões simultâneas
# Máximo 10 conexões simultâneas por IP
limit_conn_zone $binary_remote_addr zone=conn_limit_zone:10m;

# Status de retorno quando limite é excedido
limit_req_status 429;
limit_conn_status 429;

# Log de rate limiting
limit_req_log_level warn;