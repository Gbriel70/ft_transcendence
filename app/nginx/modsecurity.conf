SecRuleEngine On
SecRequestBodyAccess On
SecResponseBodyAccess Off

# Log apenas ataques
SecAuditEngine RelevantOnly
SecAuditLog /var/log/modsec_audit.log

# Proteção básica contra SQL Injection e XSS
SecRule ARGS|BODY "@rx (?i:union.*select|insert.*into|delete.*from)" \
    "id:1001,phase:2,deny,status:403,msg:'SQL Injection detected'"

SecRule ARGS|BODY "@rx (?i:<script|javascript:|onerror=)" \
    "id:1002,phase:2,deny,status:403,msg:'XSS detected'"